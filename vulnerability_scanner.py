#!/usr/bin/env python

import scanner
from bs4 import BeautifulSoup
import html5lib

target_url = "URL TO TEST "


#headers = {
    'Accept': 'text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9',
    'Accept-Language': 'en-US,en;q=0.9,fr;q=0.8,nl;q=0.7',
    'Cache-Control': 'max-age=0',
    'Connection': 'keep-alive',
    # 'Cookie': 'PHPSESSID=e8ac844ldgmkpv2ngsd57j7b9v; security=impossible',
    'Origin': 'http://127.0.0.1',
    'Referer': 'http://127.0.0.1/dvwa/login.php',
    'Sec-Fetch-Dest': 'document',
    'Sec-Fetch-Mode': 'navigate',
    'Sec-Fetch-Site': 'same-origin',
    'Sec-Fetch-User': '?1',
    'Upgrade-Insecure-Requests': '1',
    'User-Agent': 'Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/107.0.0.0 Safari/537.36',
    'sec-ch-ua': '"Google Chrome";v="107", "Chromium";v="107", "Not=A?Brand";v="24"',
    'sec-ch-ua-mobile': '?0',
    'sec-ch-ua-platform': '"Linux"',
}

payload = {
    'username': 'admin',
    'password': 'password',
    'Login': 'Login',
    'user_token': '07161e451214f18bd9791d8794d5d87c',
}
#vuln_scanner = scanner.Scanner(target_url, links_to_ignore)
#test = vuln_scanner.session.get('http://127.0.0.1/dvwa/')
#soup = BeautifulSoup(test.content, 'html5lib')
#user_token = soup.find("input", {"type": "hidden", "value": True})['value']
#payload['user_token'] = user_token
#r = vuln_scanner.session.post("http://127.0.0.1/dvwa/login.php", data=payload, headers=headers)

vuln_scanner.crawl()
vuln_scanner.run_scanner()





#print(r.content.decode())
#res = vuln_scanner.submit_form(forms[0], "tessst", "http://127.0.0.1/dvwa/vulnerabilities/xss_r/")
#print(res.content.decode())
#forms = vuln_scanner.extract_forms("http://127.0.0.1/mutillidae/index.php?page=dns-lookup.php")

#response = vuln_scanner.submit_form(forms[0], "xxxx", "http://127.0.0.1/dvwa/vulnerabilities/xss_r/")

#response = vuln_scanner.test_xss_in_form(forms[1], "http://127.0.0.1/mutillidae/index.php?page=dns-lookup.php")
#print(response)



#response = vuln_scanner.test_xss_in_url("https://www.mckesson.com/Search/?term=ll")
#print(response)
# response = vuln_scanner.submit_form(forms[0], "xxxxxxxxxx", 'http://127.0.0.1/dvwa/vulnerabilities/xss_r/')
#print(response.content.decode())
